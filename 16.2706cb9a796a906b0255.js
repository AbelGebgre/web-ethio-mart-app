(window.webpackJsonp=window.webpackJsonp||[]).push([[16],{GTEe:function(e,t,a){"use strict";a.r(t),a.d(t,"RefuelModule",function(){return Z});var i=a("5EWq"),o=a("Xa2L"),r=a("/1cH"),n=a("iadO"),l=a("1jcm"),s=a("d3UM"),c=a("NFeN"),u=a("qFsG"),d=a("kmnG"),b=a("0IaG"),f=a("V5BG"),p=a("Q4Mo"),h=a("jIHw"),m=a("7kUa"),v=a("3Pt+"),g=a("rEr+"),D=a("PCNd"),C=a("ofXK"),y=a("mrSG"),k=a("LRne"),V=a("7+5H"),W=a("12jx"),w=a("4ZtF"),M=a("nnAt"),I=a("fXoL"),_=a("otk6"),Q=a("H0VJ"),R=a("FKr1"),x=a("xivw");function N(e,t){if(1&e&&(I.Wb(0,"mat-error",8),I.Qc(1),I.Vb()),2&e){const e=I.hc();I.Cb(1),I.Sc("",e.displayMessage.date," ")}}function O(e,t){if(1&e&&(I.Wb(0,"mat-error",8),I.Qc(1),I.Vb()),2&e){const e=I.hc();I.Cb(1),I.Sc("",e.displayMessage.price," ")}}function B(e,t){if(1&e&&(I.Wb(0,"mat-option",35),I.Wb(1,"span",36),I.Qc(2),I.Vb(),I.Rb(3,"br"),I.Wb(4,"small",36),I.Qc(5),I.Vb(),I.Rb(6,"br"),I.Vb()),2&e){const e=t.$implicit;I.oc("value",e.id),I.Cb(2),I.Rc(e.plateNo),I.Cb(3),I.Rc(" "+e.brand+" - "+e.model)}}function S(e,t){if(1&e&&(I.Wb(0,"mat-option",35),I.Wb(1,"span",36),I.Qc(2),I.Vb(),I.Vb()),2&e){const e=t.$implicit;I.oc("value",e.id),I.Cb(2),I.Rc(e.name)}}function K(e,t){if(1&e&&(I.Wb(0,"mat-error",8),I.Qc(1),I.Vb()),2&e){const e=I.hc();I.Cb(1),I.Sc("",e.displayMessage.KM_Before_Refuel," ")}}function A(e,t){if(1&e&&(I.Wb(0,"mat-error",8),I.Qc(1),I.Vb()),2&e){const e=I.hc();I.Cb(1),I.Sc("",e.displayMessage.KM_After_Refuel," ")}}function q(e,t){if(1&e&&(I.Wb(0,"mat-error",8),I.Qc(1),I.Vb()),2&e){const e=I.hc();I.Cb(1),I.Sc("",e.displayMessage.liter," ")}}let j=(()=>{class e{constructor(e,t,a,i,o,r){var n,l,s,c,u,d,b,f,p,h,m,g,D,C,y,k,V,W,_,Q,R;this.fb=e,this.fun=t,this.dialogServices=a,this.datePipe=i,this.dateAdapter=o,this.config=r,this.formSubmit=new I.o,this.formClose=new I.o,this.drivers=[],this.cars=[],this.columns=["name","label","type","required"],this.actions=[{icon:"pencil",color:"warning",disable:!1},{icon:"trash",color:"danger"}],this.isPublished=!0,this.dialogConfig={width:"500px"},this.displayMessage={},this.dateAdapter.setLocale("en-GB"),this.image=Object(w.k)(null===(n=this.config.formData)||void 0===n?void 0:n.image)?null===(l=this.config.formData)||void 0===l?void 0:l.image:Object(w.p)(null===(s=this.config.formData)||void 0===s?void 0:s.image)?[null===(c=this.config.formData)||void 0===c?void 0:c.image]:Object(w.q)(null===(u=this.config.formData)||void 0===u?void 0:u.image)?[null===(d=this.config.formData)||void 0===d?void 0:d.image]:[],null===(f=null===(b=this.config.lookupData)||void 0===b?void 0:b.drivers)||void 0===f||f.subscribe(e=>{this.drivers=this.fun.extractData(e)}),null===(h=null===(p=this.config.lookupData)||void 0===p?void 0:p.cars)||void 0===h||h.subscribe(e=>{this.cars=this.fun.extractData(e)}),this.isPublished=void 0===(null===(m=this.config.formData)||void 0===m?void 0:m.status)||(null===(g=this.config.formData)||void 0===g?void 0:g.status),this.form=this.fb.group({id:null===(D=this.config.formData)||void 0===D?void 0:D.id,date:[new Date(null===(C=this.config.formData)||void 0===C?void 0:C.date)||new Date,v.x.required],price:[null===(y=this.config.formData)||void 0===y?void 0:y.price,v.x.required],driverID:[null===(k=this.config.formData)||void 0===k?void 0:k.driverID,v.x.required],carID:[null===(V=this.config.formData)||void 0===V?void 0:V.carID,v.x.required],KM_Before_Refuel:[null===(W=this.config.formData)||void 0===W?void 0:W.KM_Before_Refuel,v.x.required],KM_After_Refuel:[null===(_=this.config.formData)||void 0===_?void 0:_.KM_After_Refuel,v.x.required],liter:null===(Q=this.config.formData)||void 0===Q?void 0:Q.liter,image:this.image,created_at:null===(R=this.config.formData)||void 0===R?void 0:R.created_at}),this.validationMessages={driverID:{required:"field is required."},date:{required:"field is required.",max:"date can't be pass current date"},price:{required:"field is required."},carID:{required:"field is required."},KM_Before_Refuel:{required:"field is required."},KM_After_Refuel:{required:"field is required.",minLength:"KM should be greaterthan before refuel."}},this.genericValidator=new M.a(this.validationMessages)}ngOnInit(){this.today=new Date,this.form.valueChanges.subscribe(()=>this.displayMessage=this.genericValidator.processMessages(this.form))}blur(e=""){this.displayMessage=this.genericValidator.processMessages(this.form),console.log(e)}keyDown(e,t){return e.key?this.fun.allowedKey(e.key,t):(e.target.value=this.fun.removeNotAllowedKey(e.target.value,t),!0)}onChange(e,t="car"){var a,i;if("car"===t){const t=null===(a=this.cars.filter(t=>t.id===e.value)[0])||void 0===a?void 0:a.driverID;this.form.controls.driverID.patchValue(t||null)}else{const t=null===(i=this.cars.filter(t=>t.driverID===e.value)[0])||void 0===i?void 0:i.id;null===this.form.value.carID&&this.form.controls.carID.patchValue(t||null)}}setValidation(e=null){this.form.controls.plateNo.setErrors({found:!0}),this.displayMessage=this.genericValidator.processMessages(this.form)}getFile(e){this.form.controls.image.setValue((null==e?void 0:e.upload.length)>0?null==e?void 0:e.upload:[])}onSubmit(){var e,t,a;const i=this.form.value,o=null===(e=this.drivers)||void 0===e?void 0:e.filter(e=>e.id===i.driverID)[0],r=null===(t=this.cars)||void 0===t?void 0:t.filter(e=>e.id===i.carID)[0],n=Object.assign(Object.assign({},i),{driverName:null===(a=null==o?void 0:o.name)||void 0===a?void 0:a.split(" ")[0],plateNo:null==r?void 0:r.plateNo});this.formSubmit.emit(n)}onCancel(){this.formClose.emit()}}return e.\u0275fac=function(t){return new(t||e)(I.Qb(v.e),I.Qb(_.a),I.Qb(Q.a),I.Qb(C.e),I.Qb(R.a),I.Qb(b.a))},e.\u0275cmp=I.Kb({type:e,selectors:[["app-refuel-form"]],outputs:{formSubmit:"formSubmit",formClose:"formClose"},decls:85,vars:16,consts:[["autocomplete","off",3,"formGroup","submit"],["mat-dialog-title","",1,"p-dialog-header","p-d-flex","p-jc-lg-between",2,"padding","0.2re 0.3rem"],[1,"p-dialog-title","capitalize"],["pButton","","pRipple","","icon","pi pi-times",1,"shadow-none","p-button-rounded","p-button-plain","p-button-text","p-mr-1",3,"click"],["mat-dialog-content","",1,"p-dialog-content"],[1,"p-grid"],[1,"p-col-12","p-md-6"],[1,"full-width"],[1,"error"],["matInput","","formControlName","date",3,"matDatepicker","max"],["matSuffix","",3,"for"],["translate","DD/MM/YYYY","disabled","false",3,"touchUi"],["dp3",""],["class","error",4,"ngIf"],["matInput","","tabindex","0","type","text","value","","formControlName","price",3,"blur","input","keydown"],["price",""],["placeholder","choose car","formControlName","carID",3,"selectionChange"],[3,"value",4,"ngFor","ngForOf"],["placeholder","choose driver","formControlName","driverID",3,"selectionChange"],["matInput","","tabindex","0","type","text","value","","formControlName","KM_Before_Refuel",3,"blur","input","keydown"],["KM_Before_Refuel",""],["matInput","","tabindex","0","type","text","value","","formControlName","KM_After_Refuel",3,"blur","input","keydown"],["KM_After_Refuel",""],[1,"p-col-12"],["matInput","","tabindex","0","type","text","value","","formControlName","liter",3,"blur","input","keydown"],["liter",""],[3,"uploadedFile","limit","fileDropped"],["fileImage",""],["mat-dialog-actions","",1,"p-dialog-footer","button-row"],["pbutton","","pripple","","label","Cancel","type","button","icon","pi pi-times",1,"p-button-text","p-ripple","p-button","p-component","shadow-none","p-mr-2",3,"click"],["aria-hidden","true",1,"p-button-icon","p-button-icon-left","pi","pi-times"],[1,"p-button-label"],[1,"p-ink"],["pbutton","","pripple","","label","Save","icon","pi pi-check","type","submit",1,"p-button-text","p-ripple","p-button","p-component","shadow-none",3,"disabled"],["aria-hidden","true",1,"p-button-icon","p-button-icon-left","pi","pi-check"],[3,"value"],[1,"capitalize"]],template:function(e,t){if(1&e){const e=I.Xb();I.Wb(0,"form",0),I.ec("submit",function(){return t.onSubmit()}),I.Wb(1,"div",1),I.Wb(2,"div",2),I.Qc(3),I.Vb(),I.Wb(4,"button",3),I.ec("click",function(){return t.onCancel()}),I.Vb(),I.Vb(),I.Wb(5,"div",4),I.Wb(6,"div",5),I.Wb(7,"div",6),I.Wb(8,"mat-form-field",7),I.Wb(9,"mat-label"),I.Qc(10,"Date"),I.Wb(11,"span",8),I.Qc(12,"*"),I.Vb(),I.Vb(),I.Rb(13,"input",9),I.Wb(14,"mat-hint"),I.Qc(15,"MM/DD/YYYY"),I.Vb(),I.Rb(16,"mat-datepicker-toggle",10),I.Rb(17,"mat-datepicker",11,12),I.Oc(19,N,2,1,"mat-error",13),I.Vb(),I.Vb(),I.Wb(20,"div",6),I.Wb(21,"mat-form-field",7),I.Wb(22,"mat-label"),I.Qc(23,"Price"),I.Wb(24,"span",8),I.Qc(25,"*"),I.Vb(),I.Vb(),I.Wb(26,"input",14,15),I.ec("blur",function(){return t.blur()})("input",function(e){return t.keyDown(e,"price")})("keydown",function(e){return t.keyDown(e,"price")}),I.Vb(),I.Oc(28,O,2,1,"mat-error",13),I.Vb(),I.Vb(),I.Wb(29,"div",6),I.Wb(30,"mat-form-field",7),I.Wb(31,"mat-label"),I.Qc(32,"Car"),I.Wb(33,"span",8),I.Qc(34,"*"),I.Vb(),I.Vb(),I.Wb(35,"mat-select",16),I.ec("selectionChange",function(e){return t.onChange(e,"car")}),I.Oc(36,B,7,3,"mat-option",17),I.Vb(),I.Vb(),I.Vb(),I.Wb(37,"div",6),I.Wb(38,"mat-form-field",7),I.Wb(39,"mat-label"),I.Qc(40,"Driver"),I.Wb(41,"span",8),I.Qc(42,"*"),I.Vb(),I.Vb(),I.Wb(43,"mat-select",18),I.ec("selectionChange",function(e){return t.onChange(e,"driver")}),I.Oc(44,S,3,2,"mat-option",17),I.Vb(),I.Vb(),I.Vb(),I.Wb(45,"div",6),I.Wb(46,"mat-form-field",7),I.Wb(47,"mat-label"),I.Qc(48,"KM Before Refueling"),I.Wb(49,"span",8),I.Qc(50,"*"),I.Vb(),I.Vb(),I.Wb(51,"input",19,20),I.ec("blur",function(){return t.blur()})("input",function(e){return t.keyDown(e,"float")})("keydown",function(e){return t.keyDown(e,"float")}),I.Vb(),I.Oc(53,K,2,1,"mat-error",13),I.Vb(),I.Vb(),I.Wb(54,"div",6),I.Wb(55,"mat-form-field",7),I.Wb(56,"mat-label"),I.Qc(57,"KM After Refueling"),I.Wb(58,"span",8),I.Qc(59,"*"),I.Vb(),I.Vb(),I.Wb(60,"input",21,22),I.ec("blur",function(){I.Ec(e);const a=I.Bc(52);return t.blur(a.value)})("input",function(e){return t.keyDown(e,"float")})("keydown",function(e){return t.keyDown(e,"float")}),I.Vb(),I.Oc(62,A,2,1,"mat-error",13),I.Vb(),I.Vb(),I.Wb(63,"div",23),I.Wb(64,"mat-form-field",7),I.Wb(65,"mat-label"),I.Qc(66,"Liter"),I.Vb(),I.Wb(67,"input",24,25),I.ec("blur",function(){return t.blur()})("input",function(e){return t.keyDown(e,"float")})("keydown",function(e){return t.keyDown(e,"float")}),I.Vb(),I.Oc(69,q,2,1,"mat-error",13),I.Vb(),I.Vb(),I.Wb(70,"div",23),I.Wb(71,"div",7),I.Wb(72,"app-file-upload-template",26,27),I.ec("fileDropped",function(e){return t.getFile(e)}),I.Vb(),I.Vb(),I.Vb(),I.Vb(),I.Vb(),I.Wb(74,"div",28),I.Wb(75,"button",29),I.ec("click",function(){return t.onCancel()}),I.Rb(76,"span",30),I.Wb(77,"span",31),I.Qc(78,"Cancel"),I.Vb(),I.Rb(79,"span",32),I.Vb(),I.Wb(80,"button",33),I.Rb(81,"span",34),I.Wb(82,"span",31),I.Qc(83,"Save"),I.Vb(),I.Rb(84,"span",32),I.Vb(),I.Vb(),I.Vb()}if(2&e){const e=I.Bc(18);I.oc("formGroup",t.form),I.Cb(3),I.Rc(t.config.title),I.Cb(10),I.oc("matDatepicker",e)("max",t.today),I.Cb(3),I.oc("for",e),I.Cb(1),I.oc("touchUi",!0),I.Cb(2),I.oc("ngIf",t.displayMessage.date),I.Cb(9),I.oc("ngIf",t.displayMessage.price),I.Cb(8),I.oc("ngForOf",t.cars),I.Cb(8),I.oc("ngForOf",t.drivers),I.Cb(9),I.oc("ngIf",t.displayMessage.KM_Before_Refuel),I.Cb(9),I.oc("ngIf",t.displayMessage.KM_After_Refuel),I.Cb(7),I.oc("ngIf",t.displayMessage.liter),I.Cb(3),I.oc("uploadedFile",t.image)("limit",10),I.Cb(8),I.oc("disabled",!t.form.valid)}},directives:[v.y,v.r,v.i,b.g,h.b,p.a,b.e,d.c,d.g,u.b,v.c,n.d,v.q,v.g,d.f,n.f,d.h,n.c,C.m,s.a,C.l,x.a,b.c,d.b,R.h],styles:[".example-section[_ngcontent-%COMP%]{display:flex;align-content:center;align-items:center;height:60px}.buttons[_ngcontent-%COMP%]{display:flex;width:100%;justify-content:flex-end}"],changeDetection:0}),Object(y.__decorate)([Object(W.a)()],e.prototype,"blockUI",void 0),e})();var P=a("wd/R"),Y=a("DYbl"),G=a("SRE/"),E=a("sSZD"),F=a("I/3d");let L=(()=>{class e{constructor(e,t,a){this.db=e,this.firestore=t,this.fun=a,this.url="/refuel"}get(e=!1){const t=""+this.url;return e?this.firestore.collection(t,t=>t.where("status","==",e)):this.firestore.collection(t)}add(e,t=null){var a;delete e.id;const i=[],o=""+this.url;if((null===(a=null==e?void 0:e.image)||void 0===a?void 0:a.length)>0)return e.image.forEach((a,r)=>this.fun.storeToFirebase(a,this.url).then(a=>{if(i.push(a),r+1===e.image.length)return e.image=i,e.created_at=(new Date).toISOString(),this.firestore.collection(o).add(e).then(e=>{var a;null==t||t.ref.close(),null===(a=null==t?void 0:t.block)||void 0===a||a.stop()}).catch(e=>{var a;null===(a=null==t?void 0:t.block)||void 0===a||a.stop()});r++}).catch(e=>{t.block.stop(),this.fun.notify("",e,1e4)}));e.created_at=(new Date).toISOString(),this.firestore.collection(o).add(e).then(e=>{var a;null==t||t.ref.close(),null===(a=null==t?void 0:t.block)||void 0===a||a.stop()}).catch(e=>{var a;null===(a=null==t?void 0:t.block)||void 0===a||a.stop()})}update(e,t,a=null){var i;delete t.id;let o=0;const r=[];return(null===(i=null==t?void 0:t.image)||void 0===i?void 0:i.length)>0?t.image.forEach((i,n)=>null==(null==i?void 0:i.url)?this.fun.storeToFirebase(i,this.url).then(i=>{if(r.push(i),o++,n+1===t.image.length)return t.image=r,this.firestore.collection(this.url).doc(e).update(t).then(e=>{var t;null==a||a.ref.close(),null===(t=null==a?void 0:a.block)||void 0===t||t.stop()}).catch(e=>{var t;null===(t=null==a?void 0:a.block)||void 0===t||t.stop()});n++}).catch(e=>{a.block.stop(),this.fun.notify("","Something error occur",3e3)}):(r.push(null==i?void 0:i.url),0===o?(t.image=r,this.firestore.collection(this.url).doc(e).update(t).then(e=>{var t;null==a||a.ref.close(),null===(t=null==a?void 0:a.block)||void 0===t||t.stop()}).catch(e=>{var t;null===(t=null==a?void 0:a.block)||void 0===t||t.stop()})):void 0)):this.firestore.collection(this.url).doc(e).update(t).then(e=>{var t;null==a||a.ref.close(),null===(t=null==a?void 0:a.block)||void 0===t||t.stop()}).catch(e=>{var t;null===(t=null==a?void 0:a.block)||void 0===t||t.stop()})}delete(e,t=null){return this.firestore.collection(this.url).doc(e).delete()}fitch(e){const t=new Date(new Date(null==e?void 0:e.start).setHours(12,0,0,0)),a=new Date(new Date(null==e?void 0:e.end).setHours(12,0,0,0));return this.firestore.collection(this.url,e=>e.where("date",">",t).where("date","<=",a))}}return e.\u0275fac=function(t){return new(t||e)(I.ac(E.a),I.ac(F.a),I.ac(_.a))},e.\u0275prov=I.Mb({token:e,factory:e.\u0275fac,providedIn:"root"}),e})();var $=a("WLRH");function T(e,t){1&e&&(I.Wb(0,"mat-error"),I.Qc(1,"Invalid start date"),I.Vb())}function U(e,t){1&e&&(I.Wb(0,"mat-error"),I.Qc(1,"Invalid end date"),I.Vb())}let H=(()=>{class e{constructor(e,t,a,i,o,r,n){this.carService=e,this.userService=t,this.refuelService=a,this.dialogServices=i,this.dateAdapter=o,this.db=r,this.fun=n,this.caption="Refuel",this.columns=[{label:"Date",name:"date",type:"date",sortable:!0},{label:"Price",name:"price",type:"price",sortable:!0},{label:"Driver",name:"driverName",type:"link",sortable:!0},{label:"Car",name:"plateNo",type:"link",sortable:!0},{label:"Image",name:"image",type:"image",sortable:!1},{label:"Liter",name:"liter",sortable:!0},{label:"Previous KM",name:"KM_Before_Refuel",type:"price",sortable:!0},{label:"Current KM",name:"KM_After_Refuel",type:"price",sortable:!0}],this.actions=[{icon:"pencil",color:"warning",disable:!1},{icon:"trash",color:"danger"}],this.toolBarActions=[{position:"right",action:[]},{position:"left",action:[{label:"Create",icon:"plus",color:"",tooltip:null}]}],this.dates=["monday","tuesday"],this.range=new v.h({start:new v.f(null),end:new v.f(null)}),this.today=new Date,this.duration="isoWeek",this.groupedBy=[],this.dialogConfig={width:"550px",formComponent:j,service:this.refuelService},this.dialogConfigModal={closable:!0,formComponent:V.a}}ngOnInit(){let e;this.dateAdapter.setLocale("en-GB");const t=P().format("dddd").toLowerCase();e=this.dates.includes(t)?P().subtract(1,"weeks").startOf("isoWeek").toDate():P().startOf("isoWeek").toDate();const a=P().endOf("isoWeek").toDate();let i,o;this.range.controls.start.patchValue(e),this.range.controls.end.patchValue(a>new Date?new Date:a),this.getChangedData(),this.cars$=i=this.carService.get(!0).snapshotChanges(),i.subscribe(e=>this.cars=this.fun.extractData(e)),this.users$=o=this.userService.get("driver").snapshotChanges(),o.subscribe(e=>this.users=this.fun.extractData(e))}add(){this.dialogConfig.title="New Refueling",this.dialogConfig.formData="",this.dialogConfig.lookupData={drivers:this.users$,cars:this.cars$},this.dialogServices.handleDialog(this.dialogConfig)}update(e){this.dialogConfig.title="Edit Refueling",this.dialogConfig.formData=e,this.dialogConfig.lookupData={drivers:this.users$,cars:this.cars$},this.dialogServices.handleDialog(this.dialogConfig)}getChangedData(){var e;(null===(e=this.range.value)||void 0===e?void 0:e.end)&&(this.refuel$=this.onDateChange())}onDateChange(){var e;if(null===(e=this.range.value)||void 0===e?void 0:e.end){let e;this.blockUI.start("Loading...");const{start:t,end:a}=this.range.value,i=P(t).subtract(1,"day").toDate();return e=this.data=this.refuelService.fitch({start:i,end:a}).snapshotChanges(),e.subscribe(e=>{this.refuel=this.fun.extractData(e),this.blockUI.stop(),this.onGroupedByChange({value:this.groupedBy})}),e}}onGroupedByChange(e){var t;if((null===(t=null==e?void 0:e.value)||void 0===t?void 0:t.length)>0){let t=this.refuel;t=this.fun.groupedBy(t,e.value).map(e=>({driverName:e.driverName,driverID:e.driverID,plateNo:e.plateNo,date:e.date,carID:e.carID,price:this.fun.sumObjArr(null==e?void 0:e.items,"price"),count:e.items.length,items:e.items})),this.refuel$=Object(k.a)(t),this.columns=[{label:"Date",name:"date",type:"date",sortable:!0},{label:"Driver",name:"driverName",type:"link",sortable:!0},{label:"Car",name:"plateNo",type:"link",sortable:!0},{label:"Price",name:"price",type:"price",sortable:!0},{label:"refuels",name:"count",type:"link",sortable:!0}]}else this.columns=[{label:"Date",name:"date",type:"date",sortable:!0},{label:"Price",name:"price",type:"price",sortable:!0},{label:"Driver",name:"driverName",type:"link",sortable:!0},{label:"Car",name:"plateNo",type:"link",sortable:!0},{label:"Image",name:"image",type:"image",sortable:!1},{label:"Liter",name:"liter",sortable:!0},{label:"Previous KM",name:"KM_Before_Refuel",sortable:!0},{label:"Current KM",name:"KM_After_Refuel",sortable:!0}],this.refuel$=this.data}onColumnsChange(e){if("isoWeek"===e.value||"month"===e.value){let t,a;const i=P().format("dddd").toLowerCase();a=this.dates.includes(i)&&"isoWeek"===e.value?P().subtract(1,"weeks").startOf("isoWeek").toDate():P().startOf(e.value).toDate(),t=P().endOf(e.value).toDate(),t=t>new Date?new Date:t,this.range.controls.start.patchValue(a),this.range.controls.end.patchValue(t)}}onActionClick(e){"pencil"===e.type?this.update(e.data):"trash"===e.type?(this.blockUI.start("Deleting..."),this.refuelService.delete(e.data.id).then(this.blockUI.stop())):"link"===e.type&&("driverName"===e.position?this.users$.subscribe(t=>{const a=this.fun.extractData(t).filter(t=>{var a;return(null==t?void 0:t.id)===(null===(a=null==e?void 0:e.data)||void 0===a?void 0:a.driverID)}).map(e=>{var{name:t,phone:a,email:i}=e;return Object(y.__rest)(e,["name","phone","email"]),{name:t,phone:a,email:i}});if(a.length>0){const e=Object.keys(a[0]),t=this.fun.getColumns(e);this.showModalTable("Driver Info",t,a)}}):"plateNo"===e.position?this.cars$.subscribe(t=>{const a=this.fun.extractData(t).filter(t=>{var a;return(null==t?void 0:t.id)===(null===(a=null==e?void 0:e.data)||void 0===a?void 0:a.carID)}).map(e=>{var{plateNo:t,brand:a,model:i,driverName:o,image:r,status:n,company:l}=e;return Object(y.__rest)(e,["plateNo","brand","model","driverName","image","status","company"]),{plateNo:t,brand:a,model:i,driverName:o,image:r,status:n,company:l}});if(a.length>0){const e=Object.keys(a[0]),t=this.fun.getColumns(e);this.showModalTable("Car Info",t,a)}}):"count"===e.position&&this.showModalTable("refuel",[{label:"Date",name:"date",type:"date",sortable:!0},{label:"Price",name:"price",type:"price",sortable:!0},{label:"Driver",name:"driverName",type:"link",sortable:!0},{label:"Car",name:"plateNo",type:"link",sortable:!0},{label:"Image",name:"image",type:"image",sortable:!1},{label:"Liter",name:"liter",sortable:!0},{label:"Previous KM",name:"KM_Before_Refuel",sortable:!0},{label:"Current KM",name:"KM_After_Refuel",sortable:!0}],e.data.items))}showModalTable(e,t,a,i="1000px"){this.dialogConfigModal.width=i,this.dialogConfigModal.lookupData={caption:e,columns:t,data:a},this.dialogServices.handleDialog(this.dialogConfigModal)}onToolBarActionClick(e){"plus"===e&&this.add()}}return e.\u0275fac=function(t){return new(t||e)(I.Qb(Y.a),I.Qb(G.a),I.Qb(L),I.Qb(Q.a),I.Qb(R.a),I.Qb(E.a),I.Qb(_.a))},e.\u0275cmp=I.Kb({type:e,selectors:[["app-refuel"]],decls:37,vars:19,consts:[[1,"card"],[1,"p-toolbar-group-left"],[1,"p-mr-3"],[3,"value","valueChange","selectionChange"],["value","isoWeek"],["value","month"],[1,"p-ml-3"],["multiple","",3,"value","valueChange","selectionChange"],["value","driverID"],["value","carID"],["value","date"],[3,"formGroup","rangePicker","max"],["matStartDate","","formControlName","start","placeholder","Start date"],["matEndDate","","formControlName","end","placeholder","End date",3,"ngModelChange"],["matSuffix","",3,"for"],["picker",""],[4,"ngIf"],[3,"caption","columns","data","actions","selectedColumns","first","rows","sortBy","toolBarActions","buttonClick","toolBarButtonClick"]],template:function(e,t){if(1&e&&(I.Wb(0,"div",0),I.Wb(1,"p-toolbar"),I.Wb(2,"div",1),I.Wb(3,"mat-form-field",2),I.Wb(4,"mat-label"),I.Qc(5,"Duration"),I.Vb(),I.Wb(6,"mat-select",3),I.ec("valueChange",function(e){return t.duration=e})("selectionChange",function(e){return t.onColumnsChange(e)}),I.Wb(7,"mat-option",4),I.Qc(8,"Weekly"),I.Vb(),I.Wb(9,"mat-option",5),I.Qc(10,"Monthly"),I.Vb(),I.Vb(),I.Vb(),I.Wb(11,"mat-form-field",6),I.Wb(12,"mat-label"),I.Qc(13,"Grouped By"),I.Vb(),I.Wb(14,"mat-select",7),I.ec("valueChange",function(e){return t.groupedBy=e})("selectionChange",function(e){return t.onGroupedByChange(e)}),I.Wb(15,"mat-option",8),I.Qc(16,"Driver"),I.Vb(),I.Wb(17,"mat-option",9),I.Qc(18,"Car"),I.Vb(),I.Wb(19,"mat-option",10),I.Qc(20,"Date"),I.Vb(),I.Vb(),I.Vb(),I.Vb(),I.Wb(21,"div",1),I.Wb(22,"mat-form-field"),I.Wb(23,"mat-label"),I.Qc(24,"Enter a date range"),I.Vb(),I.Wb(25,"mat-date-range-input",11),I.Rb(26,"input",12),I.Wb(27,"input",13),I.ec("ngModelChange",function(){return t.getChangedData()}),I.Vb(),I.Vb(),I.Wb(28,"mat-hint"),I.Qc(29,"DD/MM/YYYY \u2013 DD/MM/YYYY"),I.Vb(),I.Rb(30,"mat-datepicker-toggle",14),I.Rb(31,"mat-date-range-picker",null,15),I.Oc(33,T,2,0,"mat-error",16),I.Oc(34,U,2,0,"mat-error",16),I.Vb(),I.Vb(),I.Vb(),I.Vb(),I.Wb(35,"app-table-template",17),I.ec("buttonClick",function(e){return t.onActionClick(e)})("toolBarButtonClick",function(e){return t.onToolBarActionClick(e)}),I.ic(36,"async"),I.Vb()),2&e){const e=I.Bc(32);I.Cb(6),I.oc("value",t.duration),I.Cb(8),I.oc("value",t.groupedBy),I.Cb(11),I.oc("formGroup",t.range)("rangePicker",e)("max",t.today),I.Cb(5),I.oc("for",e),I.Cb(3),I.oc("ngIf",t.range.controls.start.hasError("matStartDateInvalid")),I.Cb(1),I.oc("ngIf",t.range.controls.end.hasError("matEndDateInvalid")),I.Cb(1),I.oc("caption",t.caption)("columns",t.columns)("data",I.jc(36,17,t.refuel$))("actions",t.actions)("selectedColumns",t.columns)("first",(null==t.currentPage?null:t.currentPage.first)||0)("rows",(null==t.currentPage?null:t.currentPage.rows)||10)("sortBy",t.sortBy)("toolBarActions",t.toolBarActions)}},directives:[i.a,d.c,d.g,s.a,R.h,n.a,v.r,v.i,n.h,v.c,v.q,v.g,n.g,d.f,n.f,d.h,n.b,C.m,$.a,d.b],pipes:[C.b],styles:[""]}),Object(y.__decorate)([Object(W.a)()],e.prototype,"blockUI",void 0),e})();var X=a("tyNb");const J=[{path:"",component:H},{path:"**",redirectTo:""}];let z=(()=>{class e{}return e.\u0275mod=I.Ob({type:e}),e.\u0275inj=I.Nb({factory:function(t){return new(t||e)},imports:[[X.e.forChild(J)],X.e]}),e})(),Z=(()=>{class e{}return e.\u0275mod=I.Ob({type:e}),e.\u0275inj=I.Nb({factory:function(t){return new(t||e)},imports:[[C.c,z,D.a,g.f,v.k,v.v,m.b,h.c,p.b,i.b,f.a,b.f,d.e,u.c,c.a,s.b,l.b,n.e,r.a,o.a]]}),e})()}}]);